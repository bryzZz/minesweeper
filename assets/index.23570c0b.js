var z=(o,e,t)=>{if(!e.has(o))throw TypeError("Cannot "+t)};var f=(o,e,t)=>{if(e.has(o))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(o):e.set(o,t)};var c=(o,e,t)=>(z(o,e,"access private method"),t);const ee=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}};ee();function k(o,e){const t=o-.5+Math.random()*(e-o+1);return Math.round(t)}class te{constructor(e){this.name=e,this.callbacks=[]}registerCallback(e){this.callbacks.push(e)}}class se{constructor(){this.events={}}registerEvent(e){e in this.events&&delete this.events[e];const t=new te(e);this.events[e]=t}dispatchEvent(e,t){this.events[e].callbacks.forEach(n=>{n(t)})}addEventListener(e,t){this.events[e].registerCallback(t)}}const m=new se;function j({tagName:o,className:e,textContent:t,attributes:n,styles:s}){const i=document.createElement(o);if(t&&(i.textContent=t),e&&(Array.isArray(e)?i.classList.add(...e):i.classList.add(e)),n)for(const[r,l]of Object.entries(n))i.setAttribute(r,l);return s&&Object.assign(i.style,s),i}var H,ie,O,oe,p,M,g,T,b,R,S,re,F,le,y,_,A,ae;class ne{constructor(e){f(this,H);f(this,O);f(this,p);f(this,g);f(this,b);f(this,S);f(this,F);f(this,y);f(this,A);this.options=e,this.matrix=c(this,H,ie).call(this),this.isFirstClick=!0,this.highlightedCellCoords=null}getMatrix(){return this.matrix}getOptions(){return this.options}getMinesNumber(){let e=0;return c(this,p,M).call(this,t=>{t.isFlag&&(e+=1)}),this.options.minesCount-e}leftClickHandler(e){let t=null;if(c(this,p,M).call(this,a=>{a.id===e&&(t=a)}),this.isFirstClick){const a=[t,...c(this,g,T).call(this,t.y,t.x)];c(this,O,oe).call(this,a),this.isFirstClick=!1}const{isOpen:n,isMine:s,isFlag:i,number:r}=t;let l=!1;!n&&!i&&!s?(c(this,b,R).call(this,t),m.dispatchEvent("updatefield")):n&&r>0?(c(this,S,re).call(this,t),m.dispatchEvent("updatefield")):!n&&!i&&s&&(c(this,y,_).call(this),l=!0,m.dispatchEvent("updatefield")),!l&&c(this,F,le).call(this)&&c(this,A,ae).call(this)}rightClickHandler(e){for(let t=0;t<this.matrix.length;t++)for(let n=0;n<this.matrix[t].length;n++){const s=this.matrix[t][n];if(s.id===e){s.isOpen||(s.isFlag=!s.isFlag),m.dispatchEvent("updatefield");break}}}}H=new WeakSet,ie=function(){const{rowsCount:e,columnsCount:t}=this.options,n=[];let s=1;for(let i=0;i<e;i++){const r=[];for(let l=0;l<t;l++){const a={y:i,x:l,id:s.toString(),number:0,isOpen:!1,isMine:!1,isFlag:!1,isHighlighted:!1};r.push(a),s++}n.push(r)}return n},O=new WeakSet,oe=function(e){const{rowsCount:t,columnsCount:n,minesCount:s}=this.options,i=[];for(let r=0;r<s;r++){let l=k(0,t-1),a=k(0,n-1),d=this.matrix[l][a];for(;i.includes(d)||e.includes(d);)l=k(0,t-1),a=k(0,n-1),d=this.matrix[l][a];i.push(d),d.isMine=!0,c(this,g,T).call(this,d.y,d.x).forEach(u=>{u.number+=1})}},p=new WeakSet,M=function(e){const{matrix:t}=this;for(let n=0;n<t.length;n++)for(let s=0;s<t[n].length;s++)e(t[n][s])},g=new WeakSet,T=function(e,t,n=this.matrix){var i;const s=[];for(let r=-1;r<=1;r++)for(let l=-1;l<=1;l++){if(r===0&&l===0)continue;const a=(i=n==null?void 0:n[e+r])==null?void 0:i[t+l];a&&s.push(a)}return s},b=new WeakSet,R=function(e){!e.isMine&&!e.isFlag&&!e.isOpen?(e.isOpen=!0,e.number===0&&c(this,g,T).call(this,e.y,e.x).forEach(n=>{c(this,b,R).call(this,n)})):e.isMine&&c(this,y,_).call(this)},S=new WeakSet,re=function(e){const t=c(this,g,T).call(this,e.y,e.x);let n=t.reduce((s,{isFlag:i})=>i?++s:s,0);e.number===n&&t.forEach(s=>{s.isFlag||c(this,b,R).call(this,s)})},F=new WeakSet,le=function(){let e=!0;return c(this,p,M).call(this,t=>{!t.isOpen&&!t.isMine&&(e=!1)}),e},y=new WeakSet,_=function(){c(this,p,M).call(this,e=>{e.isOpen=!0}),m.dispatchEvent("lose")},A=new WeakSet,ae=function(){m.dispatchEvent("win")};var P,de,q,he,V,ue,D,fe,I,me,w,W,N,pe;class ce{constructor(e){f(this,P);f(this,q);f(this,V);f(this,D);f(this,I);f(this,w);f(this,N);this.model=e,this.html=null,this.styles={colors:{main:"#e77d26",flag:"#646464",mine:"tomato",text:"#e5e5e5",stroke:"rgb(156, 156, 156)"},font:{size:48,family:"Roboto"}},c(this,P,de).call(this)}getHtml(){return this.html}bindLeftClick(e){this.html.addEventListener("mousedown",t=>{if(t.button===0){const n=t.offsetY,s=t.offsetX,i=c(this,w,W).call(this,n,s).id;i&&e(i)}})}bindRightClick(e){this.html.addEventListener("mousedown",t=>{if(t.button===2){const n=t.offsetY,s=t.offsetX,i=c(this,w,W).call(this,n,s).id;i&&e(i)}})}updateView(e,t){const{rowsCount:n,columnsCount:s}=this.model.getOptions(),i=this.model.getMatrix(),r=this.html.getContext("2d");r.clearRect(0,0,this.html.width,this.html.height),r.beginPath(),c(this,V,ue).call(this,r,n,s,e,t*2),c(this,D,fe).call(this,r,i,e,t),r.closePath()}}P=new WeakSet,de=function(){this.html=j({tagName:"canvas",className:"minesweeper-field"}),this.html.oncontextmenu=()=>!1;const{rowsCount:e,columnsCount:t}=this.model.getOptions(),n=50,s=n*t,i=n*e,r=2,l=n*r,a=l/10;c(this,q,he).call(this,s,i,r),this.updateView(l,a),c(this,N,pe).call(this),m.registerEvent("updatefield"),m.addEventListener("updatefield",this.updateView.bind(this,l,a))},q=new WeakSet,he=function(e,t,n){this.html.style.width=e+"px",this.html.style.height=t+"px",this.html.width=e*n,this.html.height=t*n},V=new WeakSet,ue=function(e,t,n,s,i){e.strokeStyle=this.styles.colors.stroke;const r=s-i*2;for(let l=1;l<t;l++){const a=s*l;for(let d=0;d<n;d++){const u=i+d*s;e.moveTo(u,a),e.lineTo(u+r,a)}}for(let l=1;l<n;l++){const a=s*l;for(let d=0;d<t;d++){const u=i+d*s;e.moveTo(a,u),e.lineTo(a,u+r)}}e.stroke()},D=new WeakSet,fe=function(e,t,n,s){const{main:i,flag:r,mine:l}=this.styles.colors;for(let a=0;a<t.length;a++)for(let d=0;d<t[a].length;d++){const{isOpen:u,isFlag:h,isMine:v,isHighlighted:Y,number:X}=t[a][d];let L="transparent",$=null;u?v&&(L=l,$="../Group 4.svg"):(L=i,h&&(L=r));const Z=s+a*n,K=s+d*n,J=n-s*2;let Q=X>0&&u&&!v?X:"";e.beginPath(),c(this,I,me).call(this,e,K,Z,J,5,L,Q,$,Y),e.closePath()}},I=new WeakSet,me=function(e,t,n,s,i=5,r,l,a,d){if(typeof i=="number")i={tl:i,tr:i,br:i,bl:i};else{const u={tl:0,tr:0,br:0,bl:0};for(const h in u)i[h]=i[h]||u[h]}if(e.moveTo(t+i.tl,n),e.lineTo(t+s-i.tr,n),e.quadraticCurveTo(t+s,n,t+s,n+i.tr),e.lineTo(t+s,n+s-i.br),e.quadraticCurveTo(t+s,n+s,t+s-i.br,n+s),e.lineTo(t+i.bl,n+s),e.quadraticCurveTo(t,n+s,t,n+s-i.bl),e.lineTo(t,n+i.tl),e.quadraticCurveTo(t,n,t+i.tl,n),d&&(e.strokeStyle="rgb(56, 56, 255)",e.lineWidth=10,e.stroke()),e.fillStyle=r,e.fill(),l){const{colors:{text:u},font:{size:h,family:v}}=this.styles;e.fillStyle=u,e.font=`${h}px ${v}`,e.fillText(l,t+s/2.9,n+s/1.5)}},w=new WeakSet,W=function(e,t){const n=this.model.getMatrix();return e=Math.floor(e/50),t=Math.floor(t/50),n[e][t]},N=new WeakSet,pe=function(){this.html.addEventListener("mousemove",e=>{const t=e.offsetY,n=e.offsetX,s=c(this,w,W).call(this,t,n);s&&(s.isOpen?this.html.style.cursor="default":this.html.style.cursor="pointer")})};class ge{constructor(e){this.options=e,this.model=null,this.view=null,this.loseCallback=null,this.winCallback=null}start(){this.model=new ne(this.options),this.view=new ce(this.model),this.view.bindLeftClick(e=>{this.model.leftClickHandler(e)}),this.view.bindRightClick(e=>{this.model.rightClickHandler(e)}),m.registerEvent("lose"),m.registerEvent("win"),m.addEventListener("lose",()=>this.loseCallback()),m.addEventListener("win",()=>this.winCallback())}getView(){return this.view}onLose(e){this.loseCallback=e}onWin(e){this.winCallback=e}onMinesCounterChange(e){let t=this.model.getMinesNumber();e(t),m.addEventListener("updatefield",()=>{t=this.model.getMinesNumber(),e(t)})}}let C=new ge({rowsCount:10,columnsCount:10,minesCount:9});const x=document.querySelector("#app"),B=x.querySelector(".header"),E=x.querySelector(".container");function G(o){var n;o.innerHTML="",C.start();const e=C.getView().getHtml();o.append(e),(n=B.querySelector(".mines-counter"))==null||n.remove();const t=j({tagName:"div",className:"mines-counter"});C.onMinesCounterChange(s=>{t.innerHTML=`Mines left: <span>${s}</span>`}),B.append(t)}G(E);const ve=Ce(E);function Ce(o){const e=C.getView().getHtml();let t={top:0,left:0,x:0,y:0},n=!1,s=!1;document.addEventListener("keydown",i),document.addEventListener("keyup",r),o.addEventListener("mousedown",l);function i(h){h.code==="Space"&&(h.preventDefault(),s=!0,n||(o.style.cursor="grab"),e.classList.add("no-pointer-events"))}function r(h){h.code==="Space"&&(s=!1,n||(o.style.cursor="default",e.classList.remove("no-pointer-events")))}function l(h){s&&(n=!0,o.style.cursor="grabbing",t={left:o.scrollLeft,top:o.scrollTop,x:h.clientX,y:h.clientY},o.addEventListener("mousemove",a),o.addEventListener("mouseup",d))}function a(h){const v=h.clientX-t.x,Y=h.clientY-t.y;o.scrollTop=t.top-Y,o.scrollLeft=t.left-v}function d(){o.removeEventListener("mousemove",a),o.removeEventListener("mouseup",d),n=!1,s||(o.style.cursor="default",e.classList.remove("no-pointer-events"))}function u(){document.removeEventListener("keydown",i),document.removeEventListener("keyup",r),o.removeEventListener("mousedown",l)}return u}C.onWin(()=>U("You Win!","win"));C.onLose(()=>U("You Lose","lose"));function U(o,e){ve();const t=j({tagName:"div",className:["end-screen",e]});t.innerHTML=`
        <div>${o}</div>
        <div>Click any button to restart</div>
    `;const n=()=>{G(E),t.removeEventListener("click",n),document.removeEventListener("keypress",n),t.remove()};t.addEventListener("click",n),document.addEventListener("keypress",n),E.append(t),E.classList.toggle("overflow-hidden")}
